<?php
/**
 * THIS IS AN AUTOGENERATED FILE
 * DO NOT MODIFY
 * @codingStandardsIgnoreFile
 */


namespace Ls\Replication\Model\Central;

use Magento\Framework\Exception\CouldNotDeleteException;
use Magento\Framework\Exception\CouldNotSaveException;
use Magento\Framework\Exception\NoSuchEntityException;
use Magento\Framework\Api\SearchCriteriaInterface;
use Exception;
use Magento\Framework\Phrase;
use Magento\Framework\Api\SortOrder;
use Ls\Replication\Api\Central\ReplLscRetailProductGroupRepositoryInterface;
use Ls\Replication\Model\Central\ResourceModel\ReplLscRetailProductGroup\Collection;
use Ls\Replication\Model\Central\ResourceModel\ReplLscRetailProductGroup\CollectionFactory;
use Ls\Replication\Api\Central\Data\ReplLscRetailProductGroupInterface;
use Ls\Replication\Model\Central\ReplLscRetailProductGroupFactory;
use Ls\Replication\Model\Central\ReplLscRetailProductGroupSearchResultsFactory;

class ReplLscRetailProductGroupRepository implements ReplLscRetailProductGroupRepositoryInterface
{
    /**
     * @property ReplLscRetailProductGroupFactory $objectFactory
     */
    public $objectFactory = null;

    /**
     * @property CollectionFactory $collectionFactory
     */
    public $collectionFactory = null;

    /**
     * @property ReplLscRetailProductGroupSearchResultsFactory $resultFactory
     */
    public $resultFactory = null;

    public function __construct(ReplLscRetailProductGroupFactory $objectFactory, CollectionFactory $collectionFactory, ReplLscRetailProductGroupSearchResultsFactory $resultFactory)
    {
        $this->objectFactory = $objectFactory;
        $this->collectionFactory = $collectionFactory;
        $this->resultFactory = $resultFactory;
    }

    public function getList(SearchCriteriaInterface $criteria)
    {
        /** @var SearchResultInterface $results */
        $results = $this->resultFactory->create();
        $results->setSearchCriteria($criteria);

        /** @var Collection $collection */
        $collection = $this->collectionFactory->create();
        foreach ($criteria->getFilterGroups() as $filterGroup) {
            $fields = [];
            $conditions = [];
            foreach ($filterGroup->getFilters() as $filter) {
                $condition = $filter->getConditionType() ?: 'eq';
                $fields[] = $filter->getField();
                $conditions[] = [$condition => $filter->getValue()];
            }
            if ($fields) {
                $collection->addFieldToFilter($fields, $conditions);
            }
        }
        $results->setTotalCount($collection->getSize());

        $sortOrders = $criteria->getSortOrders();
        if ($sortOrders) {
            foreach ($sortOrders as $sortOrder) {
                $collection->addOrder(
                    $sortOrder->getField(),
                    ($sortOrder->getDirection() === SortOrder::SORT_ASC) ? 'ASC' : 'DESC'
                );
            }
        }

        $collection->setCurPage($criteria->getCurrentPage());
        $collection->setPageSize($criteria->getPageSize());

        $objects = [];
        foreach ($collection as $objectModel) {
            $objects[] = $objectModel;
        }
        $results->setItems($objects);

        return $results;
    }

    public function save(ReplLscRetailProductGroupInterface $object)
    {
        try {
            $object->save();
        } catch (Exception $e) {
            throw new CouldNotSaveException(new Phrase($e->getMessage()));
        }

        return $object;
    }

    public function getById($id)
    {
        $object = $this->objectFactory->create();
        $object->load($id);
        if (!$object->getId()) {
            throw new NoSuchEntityException(new Phrase("Object with id '$id' does not exist."));
        }

        return $object;
    }

    public function delete(ReplLscRetailProductGroupInterface $object)
    {
        try {
            $object->delete();
        } catch (Exception $e) {
            throw new CouldNotDeleteException(new Phrase($e->getMessage()));
        }

        return true;
    }

    public function deleteById($id)
    {
        return $this->delete($this->getById($id));
    }
}

